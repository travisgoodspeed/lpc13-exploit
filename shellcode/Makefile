

all: shellcode.bin

main.o:
	arm-none-eabi-gcc main.c -o main.o -c -MMD -mcpu=cortex-m4 -mthumb -O0 -g3 -Wall 
shellcode.elf: main.o lpc1343fhn33.syms
	arm-none-eabi-gcc main.o -o shellcode.elf -mcpu=cortex-m4 -mthumb \
			-specs=nosys.specs -specs=nano.specs -T shellcode.ld \
			-Wl,-Map=output.map -Wl,--gc-sections \
			-Xlinker -just-symbols=lpc1343fhn33.syms

shellcode.bin: shellcode.elf
	arm-none-eabi-objcopy -O binary shellcode.elf shellcode.bin

clean:
	rm -f shellcode.elf *.o main *.d *.map *~ *.bin

dump:
	arm-none-eabi-objdump -d shellcode.elf

dumpc: shellcode.bin
	xxd -i shellcode.bin
